<!doctype html>
<html lang="fa">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no">
<title>لغت‌نامه پیشرفته — اپلیکیشن</title>

<style>
/* --- جلوگیری از انتخاب و لمس --- */
* { box-sizing: border-box; }
body, input, button, div, p, h2, h3 { user-select: none; -webkit-user-select: none; -moz-user-select: none; -ms-user-select: none; touch-action: manipulation; -webkit-tap-highlight-color: transparent; }

/* --- پس‌زمینه و بدنه --- */
body {
  margin:0; padding:0;
  font-family:'Vazir','Tahoma',sans-serif;
  background: url('https://uploadkon.ir/uploads/887115_2520251115-130525-616959630.jpg') no-repeat center center fixed;
  background-size: cover;
  display:flex; justify-content:center; align-items:center; min-height:100vh;
  -webkit-user-drag: none;
}

/* --- کانتینر شیشه‌ای --- */
.container {
  width: 94%;
  max-width:480px;
  min-width:300px;
  min-height:660px;
  background: rgba(245,215,110,0.28);
  padding: 60px 20px 40px 20px;
  border-radius:20px;
  box-shadow:0 12px 30px rgba(0,0,0,0.18);
  display:flex; flex-direction:column; position:relative;
  backdrop-filter: blur(14px); -webkit-backdrop-filter: blur(14px);
  border:1px solid rgba(255,255,255,0.25);
  overflow: hidden;
}

/* --- هدر با دکمه‌ها --- */
.header-buttons { display:flex; justify-content:space-between; margin-bottom:14px; gap:10px; }
.header-buttons button {
  width:100px; height:42px; background: rgba(255,255,255,0.18);
  backdrop-filter: blur(8px); -webkit-backdrop-filter: blur(8px);
  color:white; border:1px solid rgba(255,255,255,0.28); border-radius:12px;
  font-weight:700; cursor:pointer; font-size:15px; transition:0.22s; box-shadow:0 6px 14px rgba(0,0,0,0.12);
}
.header-buttons button:hover { transform: translateY(-3px) scale(1.02); }

/* --- فونت نستعلیق برای عنوان --- */
@import url('https://cdn.fontcdn.ir/Font/Persian/IranNastaliq/IranNastaliq.css');
h2 { text-align:center; font-family: 'IranNastaliq', serif !important; font-size:46px; font-weight:normal; color:#000; -webkit-text-stroke:1px #fff; margin:18px 0 8px 0; }

/* --- ورودی و دکمه‌ها --- */
.controls { display:flex; gap:10px; margin-top:6px; align-items:center; }
input[type="text"] { flex:1; padding:12px 14px; border-radius:12px; border:1px solid rgba(144,202,249,0.5); font-size:15px; background: rgba(255,255,255,0.24); backdrop-filter: blur(8px); -webkit-backdrop-filter: blur(8px); }
input[type="text"]:focus { outline:none; box-shadow:0 0 10px rgba(66,165,245,0.18); border-color: rgba(66,165,245,0.6); }
.btn { padding:11px 12px; border-radius:12px; border:none; cursor:pointer; color:white; font-weight:700; font-size:14px; }
.btn.search { background: linear-gradient(135deg,#42a5f5,#1e88e5); box-shadow:0 6px 16px rgba(66,133,245,0.16); }
.btn.random { background: linear-gradient(135deg,#26a69a,#00796b); box-shadow:0 6px 16px rgba(38,166,154,0.16); }
.btn.ghost { background: rgba(255,255,255,0.14); color:#fff; border:1px solid rgba(255,255,255,0.18); }

/* --- suggestion/history/result containers --- */
.section { margin-top:12px; display:flex; flex-direction:column; gap:8px; }
.box {
  background:#f8fcff; border-radius:14px; padding:10px; max-height:220px; overflow:auto;
  box-shadow: inset 0 6px 14px rgba(10,20,40,0.02);
}
.suggestions div, .history div, .result div {
  display:flex; gap:10px; align-items:center; padding:8px; margin:6px 0; background:#fff; border-radius:12px; cursor:pointer;
  border:1px solid rgba(144,202,249,0.45); transition:transform .15s, background .15s;
}
.suggestions div:hover, .history div:hover, .result div:hover { transform:translateY(-3px); background:#e8f3ff; }

/* thumbnail inside item */
.item-thumb { width:70px; height:70px; border-radius:10px; object-fit:cover; flex-shrink:0; background:#efefef; }

/* result text */
.item-body { display:flex; flex-direction:column; gap:6px; }

/* modal */
#modal { position:fixed; inset:0; display:none; align-items:center; justify-content:center; background: rgba(0,0,0,0.55); z-index:999; padding:20px; }
#modalBox { width:100%; max-width:520px; background:white; border-radius:16px; padding:18px; box-shadow:0 18px 50px rgba(0,0,0,0.45); max-height:88vh; overflow:auto; direction:rtl; text-align:right; }
#modalBox img { width:100%; border-radius:10px; margin-bottom:12px; }

/* small helpers */
.small { font-size:13px; color:#5b6b86; }

/* prevent text selection in inputs on mobile double tap */
input::selection { background: transparent; }

/* responsive */
@media (max-width:420px) {
  .header-buttons button { width:86px; font-size:13px; }
  h2 { font-size:28px; }
  .item-thumb { width:56px; height:56px; }
}
</style>
</head>
<body>
<div class="container" role="application" aria-label="لغت‌نامه اپلیکیشن">
  <div class="header-buttons" role="navigation">
    <button onclick="goHome()">ریست</button>
    <button onclick="openAbout()">درباره</button>
  </div>

  <h2></h2>

  <div class="controls" aria-hidden="false">
    <input id="q" type="text" placeholder="کلمه یا عبارت را وارد کنید" aria-label="جستجو">
    <button id="searchBtn" class="btn search">جستجو</button>
    <button id="randomBtn" class="btn random">تصادفی</button>
  </div>

  <div class="section">
    <div class="box suggestions" id="suggestions" aria-live="polite"></div>
    <div class="box history" id="history"></div>
    <div class="box result" id="result" aria-live="polite"></div>
  </div>
</div>

<!-- مودال بزرگ -->
<div id="modal" role="dialog" aria-modal="true" style="display:none;">
  <div id="modalBox">
<button class="btn ghost" style="float:left; background:black; color:white;" onclick="closeModal()">بستن</button>
    <div id="modalContent"></div>
  </div>
</div>

<script>
function openModal(content) {
    document.getElementById("modalContent").innerHTML = content;
    document.getElementById("modal").style.display = "flex";
}

function closeModal() {
    document.getElementById("modal").style.display = "none";
}

// بستن مودال با کلیک روی زمینه بیرونی
document.getElementById("modal").addEventListener("click", function (e) {
    if (e.target === this) {
        closeModal();
    }
});
</script>


<script>
/* ====== تنظیمات و متغیرها ====== */
const API_ROOT = 'https://fa.wikipedia.org/w/api.php?origin=*';
const qInput = document.getElementById('q');
const searchBtn = document.getElementById('searchBtn');
const randomBtn = document.getElementById('randomBtn');
const suggestionsEl = document.getElementById('suggestions');
const historyEl = document.getElementById('history');
const resultEl = document.getElementById('result');
const modal = document.getElementById('modal');
const modalContent = document.getElementById('modalContent');

/* تاریخچه از localStorage */
let historyList = JSON.parse(localStorage.getItem('searchHistory') || '[]');
/* ====== کمک‌کننده‌ها ====== */
function renderHistory() {
  historyEl.innerHTML = '';
  if (!historyList.length) {
    historyEl.innerHTML = '<div class="small">تاریخچه خالی است</div>';
    return;
  }
  // دکمه پاک کردن
  const clearBtn = document.createElement('div');
  clearBtn.innerHTML = '<strong class="small">پاک کردن تاریخچه</strong>';
  clearBtn.style.textAlign = 'center';
  clearBtn.style.cursor = 'pointer';
  clearBtn.onclick = () => { historyList = []; localStorage.removeItem('searchHistory'); renderHistory(); };
  historyEl.appendChild(clearBtn);

  historyList.forEach(item => {
    const d = document.createElement('div');
    d.textContent = item;
    d.onclick = () => { qInput.value = item; searchAndShow(item); };
    historyEl.appendChild(d);
  });
}

function saveHistory(term) {
  if (!term) return;
  // حذف موارد تکراری و اضافه به اول
  historyList = historyList.filter(x => x !== term);
  historyList.unshift(term);
  if (historyList.length > 20) historyList = historyList.slice(0,20);
  localStorage.setItem('searchHistory', JSON.stringify(historyList));
  renderHistory();
}

function showModal(html) {
  modalContent.innerHTML = html;
  modal.style.display = 'flex';
  document.body.style.overflow = 'hidden';
}
function closeModal(e) {
  if (e && e.target !== modal) return;
  modal.style.display = 'none';
  modalContent.innerHTML = '';
  document.body.style.overflow = '';
}

/* ====== نمایش آیتم نتیحه با عکس کوچک ====== */
function makeResultItem(title, extract, thumbUrl, pageid) {
  const wrapper = document.createElement('div');
  wrapper.style.alignItems = 'flex-start';
  // thumbnail
  if (thumbUrl) {
    const img = document.createElement('img');
    img.src = thumbUrl;
    img.className = 'item-thumb';
    wrapper.appendChild(img);
  }
  const body = document.createElement('div');
  body.className = 'item-body';
  const t = document.createElement('strong'); t.textContent = title;
  const p = document.createElement('div'); p.textContent = extract || '';
  const link = document.createElement('a'); link.href = 'https://fa.wikipedia.org/?curid=' + pageid; link.target = '_blank';
  link.textContent = 'نمایش در ویکی‌پدیا ›';
  link.className = 'small';
  body.appendChild(t); body.appendChild(p); body.appendChild(link);
  wrapper.appendChild(body);

  // کلیک برای مودال (نمایش بزرگتر و متن کامل)
  wrapper.onclick = async (e) => {
    e.preventDefault();
    // show modal with fuller content (try rest summary)
    try {
      const resp = await fetch('https://fa.wikipedia.org/api/rest_v1/page/summary/' + encodeURIComponent(title));
      if (resp.ok) {
        const data = await resp.json();
        let html = '';
        if (data.thumbnail && data.thumbnail.source) html += '<img src="'+data.thumbnail.source+'" alt="">';
        html += '<h3>' + (data.title || title) + '</h3>';
        html += '<p>' + (data.extract || '') + '</p>';
        if (data.content_urls && data.content_urls.desktop) html += '<p style="margin-top:8px;"><a href="'+data.content_urls.desktop.page+'" target="_blank">مشاهده کامل در ویکی‌پدیا</a></p>';
        showModal(html);
      } else {
        showModal('<p>خطا در دریافت اطلاعات کامل.</p>');
      }
    } catch(err) {
      console.error(err);
      showModal('<p>خطا در دریافت اطلاعات.</p>');
    }
  };

  return wrapper;
}

/* ====== جستجو و دریافت نتایج ====== */
let debounceTimer = null;
qInput.addEventListener('input', () => {
  clearTimeout(debounceTimer);
  debounceTimer = setTimeout(handleSuggest, 250);
});

async function handleSuggest() {
  const term = qInput.value.trim();
  suggestionsEl.innerHTML = '';
  if (!term) return;
  try {
    const s = await fetch(API_ROOT + '&action=opensearch&format=json&search=' + encodeURIComponent(term) + '&limit=6').then(r=>r.json());
    const titles = s[1] || [];
    titles.forEach(t => {
      const d = document.createElement('div');
      d.textContent = t;
      d.onclick = () => { qInput.value = t; searchAndShow(t); };
      suggestionsEl.appendChild(d);
    });
  } catch(err) {
    suggestionsEl.innerHTML = '';
  }
}

async function searchAndShow(term) {
  if (!term || !term.trim()) return;
  resultEl.innerHTML = '<div class="small">در حال جستجو...</div>';
  try {
    // 1) جستجوی عنوان‌ها
    const srResp = await fetch(API_ROOT + '&action=query&list=search&format=json&srsearch=' + encodeURIComponent(term) + '&srlimit=6');
    const sr = await srResp.json();
    if (!sr.query || !sr.query.search || sr.query.search.length === 0) {
      resultEl.innerHTML = '<div class="small">موردی یافت نشد</div>';
      return;
    }

    // برای هر عنوان، جزئیات خلاصه و thumbnail را بگیر
    const titles = sr.query.search.slice(0,6).map(s => s.title);
    // دریافت اطلاعات صفحات (extract + thumbnail)
    const params = new URLSearchParams({
      action: 'query',
      prop: 'extracts|pageimages',
      exintro: '1',
      explaintext: '1',
      piprop: 'thumbnail',
      pithumbsize: '400',
      titles: titles.join('|'),
      format: 'json'
    });
    const detailResp = await fetch(API_ROOT + '&' + params.toString());
    const details = await detailResp.json();
    const pages = details.query && details.query.pages ? details.query.pages : {};
    // پاکسازی suggestions
    suggestionsEl.innerHTML = '';
    // رندر نتایج (یکی یکی)
    resultEl.innerHTML = '';
    Object.keys(pages).forEach(k => {
      const p = pages[k];
      const title = p.title;
      const extract = p.extract || '';
      const thumb = p.thumbnail && p.thumbnail.source ? p.thumbnail.source : null;
      const pageid = p.pageid;
      const item = makeResultItem(title, extract, thumb, pageid);
      resultEl.appendChild(item);
    });

    saveHistory(term);
  } catch (err) {
    console.error(err);
    resultEl.innerHTML = '<div class="small">خطا در ارتباط با ویکی‌پدیا</div>';
  }
}

/* صفحه تصادفی */
randomBtn.addEventListener('click', async () => {
  try {
    const r = await fetch(API_ROOT + '&action=query&format=json&list=random&rnnamespace=0&rnlimit=1').then(r=>r.json());
    const title = r.query.random[0].title;
    qInput.value = title;
    searchAndShow(title);
  } catch (err) {
    console.error(err);
    resultEl.innerHTML = '<div class="small">خطا در دریافت صفحهٔ تصادفی</div>';
  }
});

/* جستجو با دکمه یا اینتر */
searchBtn.addEventListener('click', ()=>searchAndShow(qInput.value));
qInput.addEventListener('keydown', (e)=>{ if (e.key === 'Enter') { e.preventDefault(); searchAndShow(qInput.value); } });

/* تاریخچه اولیه */
(function init() {
  renderHistory();
  // اختیاری: نمایش یک نمونه
  // qInput.value = 'گربه'; searchAndShow('گربه');
})();

/* خانه و درباره */
function goHome(){ qInput.value=''; suggestionsEl.innerHTML=''; resultEl.innerHTML=''; }
function openAbout(){ showModal('<h3>درباره</h3><p>این اپلیکیشن لغت‌نامه از ویکی‌پدیا استفاده می‌کند. طراحی اپلیکیشنی، نمایش تصاویر، پیشنهادهای زنده و تاریخچه دارد.</p>'); }

/* جلوگیری از راست کلیک و میانبرهای کپی */
document.addEventListener('contextmenu', e => e.preventDefault());
document.addEventListener('keydown', e => {
  if ((e.ctrlKey || e.metaKey) && ['c','x','s','u','a'].includes((e.key||'').toLowerCase())) e.preventDefault();
  if (e.key === 'F12') e.preventDefault();
});

/* جلوگیری از زوم/پینچ */
document.addEventListener('gesturestart', e => e.preventDefault());
document.addEventListener('touchmove', e => { if (e.scale && e.scale !== 1) e.preventDefault(); }, { passive:false });

</script>







<script>
(function () {

  const container = document.querySelector(".container");
  if (!container) return;

  // تشخیص اندازه تقریبی اینچ
  function detectInch() {
      const dpi = window.devicePixelRatio * 96;   // DPI تقریبی
      const wInch = window.innerWidth / dpi;
      const hInch = window.innerHeight / dpi;
      const diagonal = Math.sqrt(wInch*wInch + hInch*hInch);
      return diagonal;        // اینچ تقریبی
  }

  function applyScale() {
      const inch = detectInch();
      let scale = 1;

 // ---- گوشی‌های کوچک ----
if (inch <= 4.0) scale = 0.90;      // 4.0"
else if (inch <= 4.5) scale = 0.97; // 4.5"
else if (inch <= 5.0) scale = 1.03; // 5.0"
else if (inch <= 5.5) scale = 1.10; // 5.5"
else if (inch <= 6.0) scale = 1.17; // 6.0"
else if (inch <= 6.5) scale = 1.23; // 6.5"
else if (inch <= 7.0) scale = 1.30; // 7.0"

// ---- تبلت‌ها ----
else if (inch <= 8.0) scale = 1.37;  // 8"
else if (inch <= 9.0) scale = 1.42;  // 9"
else if (inch <= 10.0) scale = 1.48; // 10"
else if (inch <= 11.0) scale = 1.55; // 11"
else if (inch <= 12.0) scale = 1.62; // 12"

// ---- لپتاپ/مانیتور ----
else if (inch <= 13.0) scale = 1.68; // 13"
else if (inch <= 14.0) scale = 1.75; // 14"
else if (inch <= 15.0) scale = 1.82; // 15"

// ---- خیلی بزرگ‌تر از 15 اینچ ----
else scale = 1.90;


      container.style.transform = `scale(${scale})`;
      container.style.transformOrigin = "top center";
  }

  // اجرای اولیه
  applyScale();

  // واکنش به تغییر سایز
  window.addEventListener("resize", applyScale);
  window.addEventListener("orientationchange", applyScale);

})();
</script>











  


</script>
</body>
</html>
